<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¡ˆå•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆç‹€æ…‹è¿½è¹¤ (Project Issues &amp; Solutions Status)</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --bg-color: #f8f9fa;
            --text-color: #333;
            --border-color: #e9ecef;
            --white: #ffffff;
            --success-color: #2ecc71;
            --warning-color: #f1c40f;
            --danger-color: #e74c3c;
            --info-color: #95a5a6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
        }

        /* Sidebar Navigation */
        .sidebar {
            position: sticky;
            top: 20px;
            height: fit-content;
            background: var(--white);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .sidebar h3 {
            margin-bottom: 15px;
            font-size: 1.1em;
            color: var(--secondary-color);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }

        .nav-link {
            display: block;
            color: var(--text-color);
            text-decoration: none;
            padding: 8px 0;
            font-size: 0.95em;
            transition: color 0.2s;
        }

        .nav-link:hover {
            color: var(--accent-color);
        }

        .nav-link.sub-link {
            padding-left: 15px;
            font-size: 0.9em;
            color: #666;
        }

        /* Main Content */
        .main-content {
            background: var(--white);
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        h1, h2, h3, h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        h1 {
            font-size: 2.2em;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        h2 {
            font-size: 1.8em;
            margin-top: 40px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        h3 {
            font-size: 1.4em;
            margin-top: 30px;
            color: var(--secondary-color);
        }

        p {
            margin-bottom: 1rem;
        }

        /* Tables */
        .table-wrapper {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 0 0 1px var(--border-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--white);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: #f1f3f5;
            color: var(--secondary-color);
            font-weight: 600;
            white-space: nowrap;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:hover {
            background-color: #e9ecef;
        }

        /* Status Badges */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 500;
            white-space: nowrap;
        }

        .badge.done {
            background-color: rgba(46, 204, 113, 0.15);
            color: #27ae60;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .badge.pending {
            background-color: rgba(241, 196, 15, 0.15);
            color: #d35400;
            border: 1px solid rgba(241, 196, 15, 0.3);
        }

        .badge.paused {
            background-color: rgba(149, 165, 166, 0.15);
            color: #7f8c8d;
            border: 1px solid rgba(149, 165, 166, 0.3);
        }

        /* Code Blocks */
        code {
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            background-color: #f1f3f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.9em;
            color: #c7254e;
        }

        .mermaid {
            margin: 20px 0;
            padding: 10px;
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow-x: auto;
        }

        /* Lists */
        ul, ol {
            margin-left: 20px;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 5px;
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--accent-color);
            background-color: #f8f9fa;
            padding: 15px;
            margin: 20px 0;
            font-style: italic;
            color: #555;
        }

        /* Links */
        a {
            color: var(--accent-color);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
                margin-bottom: 20px;
            }

            .main-content {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h3>ç›®éŒ„ (Table of Contents)</h3>
            <nav>
                <a href="#section-1" class="nav-link">1. ç›®å‰å•é¡Œè¿½è¹¤</a>
                <a href="#section-2" class="nav-link">2. é–‹æº LLM æ¨¡å‹ä½ˆç½²</a>
                <a href="#section-2-1" class="nav-link sub-link">(1) é¸æ“‡çš„é–‹æº LLM æ¨¡å‹</a>
                <a href="#section-2-2" class="nav-link sub-link">(2) éƒ¨ç½²æ–¹å¼</a>
                <a href="#section-2-3" class="nav-link sub-link">(3) éƒ¨ç½²é‡åˆ°çš„å•é¡Œèˆ‡è§£æ±º</a>
                <a href="#section-3" class="nav-link">3. Domain Knowledge Graph</a>
                <a href="#section-3-step" class="nav-link sub-link">æ­¥é©Ÿèªªæ˜</a>
                <a href="#section-3-0" class="nav-link sub-link">(0) å¯¦ä½œå°æ‡‰</a>
                <a href="#section-3-1" class="nav-link sub-link">(1) åˆ©ç”¨ LLM å»ºç«‹ KG</a>
                <a href="#section-3-2" class="nav-link sub-link">(2) ä½¿ç”¨è€…å•é¡Œè½‰ Graph DB (NL2Cypher)</a>
                <a href="#section-3-3" class="nav-link sub-link">(3) é¸æ“‡ Neo4j çš„åŸå› </a>
                <a href="#section-4" class="nav-link">4. OpenClaw æ¶æ§‹èˆ‡æŠ€èƒ½å®‰å…¨åˆ†æ</a>
                <a href="#section-4-1" class="nav-link sub-link">(1) ç³»çµ±æ¶æ§‹èˆ‡ä¸»è¦çµ„ä»¶</a>
                <a href="#section-4-2" class="nav-link sub-link">(2) å®‰å…¨é¢¨éšªï¼ˆ3 å¤§é¡ 10 é …ï¼‰</a>
                <a href="#section-4-3" class="nav-link sub-link">(3) æŠ€èƒ½å®‰å…¨å¯©æŸ¥æ©Ÿåˆ¶</a>
            </nav>
        </aside>

        <main class="main-content">
            <h1>å°ˆæ¡ˆå•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆç‹€æ…‹è¿½è¹¤ (Project Issues &amp; Solutions Status)</h1>

            <section id="section-1">
                <h2>1. ç›®å‰å•é¡Œè¿½è¹¤ (Current Issues Tracking)</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 30%">å•é¡Œ (Problem)</th>
                                <th style="width: 50%">è§£æ³• (Solution)</th>
                                <th style="width: 20%">ç‹€æ…‹ (Status)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Chat æ‰“åˆ°éŒ¯èª¤ upstreamï¼ˆ/api/chat 404ï¼‰</strong></td>
                                <td>æ”¹æˆå…±ç”¨ LLM æŠ½è±¡å±¤ï¼Œæ”¯æ´ openai-compatible / ollama / geminiï¼Œç”±ç’°å¢ƒè®Šæ•¸åˆ‡æ›ã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>llm_client.py</code>, <code>logic.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>Gemini é‡‘é‘°æœªç”Ÿæ•ˆï¼ˆ400 INVALID_ARGUMENTï¼‰</strong></td>
                                <td>çµ±ä¸€è®€å– .env.localã€è£œæ–‡ä»¶èˆ‡ç¯„ä¾‹ envï¼Œæ˜ç¢ºè¦æ±‚ GEMINI_API_KEYã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>.env.local.example</code>, <code>README.md</code></td>
                            </tr>
                            <tr>
                                <td><strong>æŠ½å–å¸¸å‡ºç¾ JSON ç ´æ/&lt;think&gt; å°è‡´ parse fail</strong></td>
                                <td>æŠ½å–åŠ  5 æ¬¡é‡è©¦ã€JSON ä¿®å¾© promptã€æé«˜è¼¸å‡º token ä¸Šé™ã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>kg_builder.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>å‰ç«¯é•·æ™‚é–“åªé¡¯ç¤º Processing...</strong></td>
                                <td>Text/File/URL æ”¹ async job + pollingï¼Œé¡¯ç¤º chunk é€²åº¦èˆ‡ç‹€æ…‹ã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>main.py</code>, <code>BuildKG.tsx</code></td>
                            </tr>
                            <tr>
                                <td><strong>é•·æ–‡æœ¬å°è‡´è¨˜æ†¶é«”å£“åŠ›ï¼ˆOOM é¢¨éšªï¼‰</strong></td>
                                <td>Ingest ç«¯æ”¹ç‚ºå…ˆåˆ‡ chunk å†é€å¡ŠæŠ½å–ï¼ˆprovider-aware token/char budgetï¼‰ï¼Œä¸¦æ”¯æ´ <code>chunk_limit</code> é™æµã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>backend/logic.py</code>, <code>backend/main.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>KG å›ç­”å¤ªç”Ÿç¡¬ã€å¸¸å¸¶ã€Œæ ¹æ“šçŸ¥è­˜åœ–è­œã€å‰ç¶´</strong></td>
                                <td>/api/query æ”¹æˆå…ˆæŸ¥ rowsï¼Œå†ç”¨ QA LLM é‡å¯«ç­”æ¡ˆï¼Œå¤±æ•—æ‰ fallbackã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>logic.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>è²¡å ±å•ç­”æŠ“ä¸åˆ°è³‡æ–™ï¼ˆæŠ½å– ontology ä¸è¶³ï¼‰</strong></td>
                                <td>æ–°å¢ FinancialMetric/FiscalPeriod èˆ‡ HAS_FINANCIAL_METRIC/FOR_PERIODï¼Œä¸¦ä¿ç•™è²¡å ±å±¬æ€§ã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>kg_builder.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>è²¡å ± Cypher æœƒå‡ºç¾ã€Œç¡¬ç·¨ç¢¼å‡è³‡æ–™ã€</strong></td>
                                <td>åŠ å®ˆé–€ï¼Œç¦æ­¢å¸¸å€¼å½é€ ï¼›è²¡å ±å•é¡Œå¼·åˆ¶ä½¿ç”¨è²¡å ±é—œä¿‚è·¯å¾‘ï¼Œå¿…è¦æ™‚èµ° deterministic fallbackã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>nl2cypher.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>è²¡å ±é—œä¿‚æ›¾ç™¼ç”Ÿè·¨å­£åº¦èª¤é€£ï¼ˆQ2 metric é€£åˆ° Q3ï¼‰</strong></td>
                                <td>FOR_PERIOD åŠ ä¸€è‡´æ€§æª¢æŸ¥ï¼Œä¸ä¸€è‡´ç›´æ¥ä¸Ÿæ£„ã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>kg_builder.py</code></td>
                            </tr>
                            <tr>
                                <td><strong>MoM/YoY å•é¡Œè§¸ç™¼ Cypher syntax errorï¼ˆ500ï¼‰</strong></td>
                                <td>1. æ“´å……è²¡å ±åµæ¸¬è©ï¼ˆmom/yoy/æœˆå¢/å¹´å¢ï¼‰<br>2. æ–°å¢ Cypher èªæ³•å®ˆé–€ï¼ˆæ””æˆª label {function(...)} é¡å‹ï¼‰<br>3. é‡è©¦å¤±æ•—æ™‚å›å¯è§£é‡‹ç­”æ¡ˆè€Œä¸æ˜¯ 500</td>
                                <td><span class="badge pending">ğŸš§ å¾…å¯¦ä½œ</span><br>(å»ºè­°å„ªå…ˆä¿®å¾©)</td>
                            </tr>
                            <tr>
                                <td><strong>ä¸€å¥å¤šå•ï¼ˆä¾‹å¦‚ã€Œè‘£äº‹é•· + å‰µè¾¦äººã€ï¼‰</strong></td>
                                <td>å¤šæ„åœ–æ‹†è§£æˆå¤š Cypher å†åˆä½µç­”æ¡ˆã€‚</td>
                                <td><span class="badge paused">â¸ï¸ ç›®å‰åˆ»æ„ä¸è™•ç†</span><br>(æš«ç·©)</td>
                            </tr>
                            <tr>
                                <td><strong>å¯¦é«”æ¼æŠ½å•é¡Œ</strong></td>
                                <td>Gemini èµ°å…©éšæ®µæŠ½å–ï¼šå…ˆç›¤é» entity æ¯”å° KG è£œé½Šï¼Œå†ç¬¬äºŒè¼ªæŠ½ relationã€‚</td>
                                <td><span class="badge done">âœ… å·²å®Œæˆ</span><br><code>kg_builder.py</code>, <code>GEMINI_TWO_PASS_EXTRACTION=1</code></td>
                            </tr>
                            <tr>
                                <td><strong>OpenClaw Skill å®‰å…¨å¯©æŸ¥è¦†è“‹ä¸è¶³</strong></td>
                                <td>ç›®å‰åƒ…æœ‰ Regex éœæ…‹æª¢æŸ¥ï¼ˆ<code>skill_audit.ts</code>ï¼‰ï¼›éœ€è£œ AST åˆ†æã€æ²™ç®±å‹•æ…‹æ¸¬è©¦ã€ä¾†æºç°½ç« èˆ‡æ¬Šé™å¯©æ‰¹ã€‚</td>
                                <td><span class="badge pending">ğŸš§ å¾…å¯¦ä½œ</span></td>
                            </tr>
                            <tr>
                                <td><strong>OpenClaw æ¬Šé™æ¨¡å‹ç²’åº¦ä¸è¶³</strong></td>
                                <td>å°å…¥ capability-based æ¬Šé™ï¼ˆæª”æ¡ˆ/ç¶²è·¯/å‘½ä»¤/å¤–éƒ¨ API åˆ†é›¢æˆæ¬Šï¼‰ï¼Œé«˜é¢¨éšªæ¬Šé™éœ€é›™é‡ç¢ºèªã€‚</td>
                                <td><span class="badge pending">ğŸš§ å¾…å¯¦ä½œ</span></td>
                            </tr>
                            <tr>
                                <td><strong>OpenClaw æ©Ÿæ•æ†‘è­‰æ²»ç†ä¸è¶³</strong></td>
                                <td>ç¬¬ä¸‰æ–¹ API Token æ”¹ç”±å¯†é‘°ç®¡ç†èˆ‡éœæ…‹åŠ å¯†ä¿å­˜ï¼Œè£œ token è¼ªæ›¿ã€å¯©è¨ˆèˆ‡å¤–æ´©å‘Šè­¦ã€‚</td>
                                <td><span class="badge pending">ğŸš§ å¾…å¯¦ä½œ</span></td>
                            </tr>
                            <tr>
                                <td><strong>OpenClaw Prompt Injection é¢¨éšª</strong></td>
                                <td>å° Skill å›å‚³å…§å®¹åŠ  trusted/untrusted æ¨™è¨˜ã€æ¨¡æ¿åŒ–åŒ…è£èˆ‡æŒ‡ä»¤éš”é›¢ï¼Œé˜»æ–·ã€Œå·¥å…·è¼¸å‡ºè¦†è“‹ç³»çµ±æŒ‡ä»¤ã€ã€‚</td>
                                <td><span class="badge pending">ğŸš§ å¾…å¯¦ä½œ</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="section-2">
                <h2>2. é–‹æº LLM æ¨¡å‹ä½ˆç½²è©³ç´°èªªæ˜</h2>

                <div id="section-2-1">
                    <h3>(1) é¸æ“‡çš„é–‹æº LLM æ¨¡å‹</h3>
                    <p>æœ¬å°ˆæ¡ˆæ¡ç”¨ <strong>Hybrid æ¨¡å¼</strong>ï¼Œä¸»è¦ä½¿ç”¨ <strong>Ollama (DeepSeek R1 / Qwen 3 / Ministral 3)</strong> ä½œç‚ºæœ¬åœ°é–‹æºæ¨¡å‹ï¼Œä¸¦æ”¯æ´åˆ‡æ›è‡³ <strong>Gemini 3 Pro (Preview)</strong>ï¼ˆæˆ–ç›¸å®¹æ–°ç‰ˆæœ¬ï¼‰ä»¥ç²å¾—æ›´é«˜å“è³ªçš„çŸ¥è­˜æŠ½å–ã€‚</p>
                    
                    <ul>
                        <li><strong>é¸æ“‡æ¨¡å‹</strong>: <code>deepseek-r1:8b</code> / <code>qwen3</code> / <code>ministral-3:14b</code> (é€é Ollama) æˆ– <code>gemini-3-pro-preview</code>ã€‚</li>
                        <li><strong>å„ªé» (Pros)</strong>:
                            <ul>
                                <li><strong>DeepSeek R1 / Qwen 3</strong>: æ”¯æ´ <strong>Chain of Thought (CoT)</strong> æ€ç¶­éˆï¼Œé‚è¼¯æ¨ç†èƒ½åŠ›é¡¯è‘—å¢å¼·ï¼Œé©åˆè™•ç†è¤‡é›œæŒ‡ä»¤ï¼ŒåŒæ™‚ä¿æœ‰æœ¬åœ°éƒ¨ç½²çš„éš±ç§å„ªå‹¢èˆ‡ç„¡ API æˆæœ¬ã€‚</li>
                                <li><strong>Ministral 3 (14B)</strong>: åœ¨ <strong>æŒ‡ä»¤éµå®ˆ</strong> èˆ‡ <strong>çµæ§‹åŒ–è¼¸å‡º</strong> è¡¨ç¾ç©©å®šï¼Œç‰¹åˆ¥é©åˆ <strong>NL2Cypher</strong> ä»»å‹™ï¼ˆå¯é™ä½ Cypher ç”Ÿæˆåé¡Œèˆ‡æ ¼å¼æ¼‚ç§»ï¼‰ã€‚</li>
                                <li><strong>Gemini 3 Pro</strong>: æ“æœ‰è¶…é•· Context Window (<strong>1,048,576 input tokens</strong>) èˆ‡å¼·å¤§çš„é‚è¼¯æ¨ç†èƒ½åŠ›ï¼Œå°æ–¼è¤‡é›œçš„å¯¦é«”é—œä¿‚æŠ½å– (NER/RE) æº–ç¢ºç‡é€šå¸¸å„ªæ–¼å°åƒæ•¸æ¨¡å‹ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>ç¼ºé» (Cons)</strong>:
                            <ul>
                                <li><strong>DeepSeek R1 / Qwen 3</strong>: åœ¨å•Ÿç”¨ thinking æˆ–è¼¸å‡ºç´„æŸä¸è¶³æ™‚ï¼Œå¯èƒ½æ··å…¥æ€è€ƒå…§å®¹/è¨»é‡‹è€Œå°è‡´ JSON è§£æå¤±æ•— (Parse Fail)ï¼›ä¸” CoT å¯èƒ½å¢åŠ æ¨è«–æ™‚é–“ã€‚éœ€æ­é… <code>think=false</code>/<code>hidethinking</code> èˆ‡å¾Œè™•ç†ä¿è­·ã€‚</li>
                                <li><strong>Gemini 3 Pro</strong>: ä¾è³´ç¶²è·¯ï¼Œæœ‰ API Rate Limit é™åˆ¶èˆ‡æˆæœ¬ï¼Œä¸”å­˜åœ¨æ•¸æ“šå‚³è¼¸éš±ç§è€ƒé‡ã€‚</li>
                            </ul>
                        </li>
                    </ul>

                    <h4>å®˜æ–¹ Benchmark åƒè€ƒï¼ˆæˆªè‡³ 2026-02-15ï¼‰</h4>
                    <blockquote>è¨»ï¼šä»¥ä¸‹ç‚ºå®˜æ–¹æ¨¡å‹å¡/å®˜æ–¹é é¢å…¬å¸ƒçš„æˆç¸¾ï¼Œä¸åŒæ¨è«–æ¡†æ¶ã€é‡åŒ–ç‰ˆæœ¬ã€sampling è¨­å®šä¸‹ï¼Œå¯¦æ¸¬çµæœå¯èƒ½æµ®å‹•ã€‚</blockquote>

                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>æ¨¡å‹</th>
                                    <th>å®˜æ–¹æ¸¬è©¦æŒ‡æ¨™</th>
                                    <th>åˆ†æ•¸</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>deepseek-r1:8b</code>ï¼ˆOllama å°æ‡‰ <code>DeepSeek-R1-0528-Qwen3-8B</code>ï¼‰</td>
                                    <td>AIME24 / AIME25 / GPQA-Diamond / LiveCodeBench</td>
                                    <td><strong>86.0 / 76.3 / 61.1 / 60.5</strong></td>
                                </tr>
                                <tr>
                                    <td><code>qwen3:8b</code>ï¼ˆThinking, bf16ï¼‰</td>
                                    <td>LiveBench / GPQA / MMLU-Redux / AIME24</td>
                                    <td><strong>67.1 / 62.0 / 87.5 / 76.0</strong></td>
                                </tr>
                                <tr>
                                    <td><code>qwen3:8b</code>ï¼ˆNon-Thinking, bf16ï¼‰</td>
                                    <td>LiveBench / GPQA / MMLU-Redux</td>
                                    <td><strong>53.5 / 39.3 / 79.5</strong></td>
                                </tr>
                                <tr>
                                    <td><code>ministral-3:14b</code>ï¼ˆReasoningï¼‰</td>
                                    <td>AIME25 / AIME24 / GPQA-Diamond / LiveCodeBench</td>
                                    <td><strong>85.0 / 89.8 / 71.2 / 64.6</strong></td>
                                </tr>
                                <tr>
                                    <td><code>ministral-3:14b</code>ï¼ˆInstructï¼‰</td>
                                    <td>Arena Hard / WildBench / MATH Maj@1 / MM MTBench</td>
                                    <td><strong>55.1 / 68.5 / 90.4 / 8.49</strong></td>
                                </tr>
                                <tr>
                                    <td><code>gemini-3-pro-preview</code></td>
                                    <td>Humanity's Last Exam / GPQA-Diamond / AIME 2025 / MMMU-Pro</td>
                                    <td><strong>37.5 / 91.9 / 95.0 / 81.0</strong></td>
                                </tr>
                                <tr>
                                    <td><code>gemini-3-pro-preview</code></td>
                                    <td>Token limits</td>
                                    <td><strong>Input 1,048,576 / Output 65,536</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <p><strong>è³‡æ–™ä¾†æºï¼ˆå®˜æ–¹ï¼‰</strong></p>
                    <ol>
                        <li>DeepSeek æ¨¡å‹å¡ï¼š<a href="https://huggingface.co/deepseek-ai/DeepSeek-R1-0528" target="_blank">https://huggingface.co/deepseek-ai/DeepSeek-R1-0528</a></li>
                        <li>Qwen3 8B æ¨¡å‹å¡ï¼š<a href="https://huggingface.co/Qwen/Qwen3-8B-AWQ" target="_blank">https://huggingface.co/Qwen/Qwen3-8B-AWQ</a></li>
                        <li>Ministral 3 14B æ¨¡å‹å¡ï¼š<a href="https://huggingface.co/mistralai/Ministral-3-14B-Instruct-2512" target="_blank">https://huggingface.co/mistralai/Ministral-3-14B-Instruct-2512</a></li>
                        <li>Gemini 3 Pro benchmark: <a href="https://deepmind.google/technologies/gemini/pro/" target="_blank">https://deepmind.google/technologies/gemini/pro/</a></li>
                        <li>Gemini 3 Pro token limits: <a href="https://ai.google.dev/gemini-api/docs/models/gemini" target="_blank">https://ai.google.dev/gemini-api/docs/models/gemini</a></li>
                    </ol>

                    <p><strong>è§£è®€æ–¹å¼ï¼ˆå°æ‡‰ä½ çš„ä»»å‹™ï¼‰</strong></p>
                    <ul>
                        <li>NER/REï¼šå¯å„ªå…ˆåƒè€ƒ GPQAã€AIMEã€HLE é€™é¡æ¨ç†/çŸ¥è­˜å¯†é›†æŒ‡æ¨™ï¼Œä½œç‚ºã€Œè¤‡é›œé—œä¿‚æŠ½å–èƒ½åŠ›ã€çš„è¿‘ä¼¼ä»£ç†ã€‚</li>
                        <li>NL2Cypherï¼šå¯å„ªå…ˆåƒè€ƒ Arena Hardã€WildBenchã€MM MTBench èˆ‡æ¨¡å‹æ˜¯å¦åŸç”Ÿæ”¯æ´ function calling / JSON outputsï¼Œä½œç‚ºã€ŒæŒ‡ä»¤éµå®ˆ + çµæ§‹åŒ–è¼¸å‡ºã€çš„è¿‘ä¼¼ä»£ç†ã€‚</li>
                        <li>ç›®å‰æ²’æœ‰å–®ä¸€å®˜æ–¹ benchmark å¯ä»¥ç›´æ¥ç­‰åŒ NER/RE æˆ– NL2Cypherï¼Œä»å»ºè­°ä¿ç•™å°ˆæ¡ˆå…§éƒ¨å›æ­¸æ¸¬è©¦é›†ä½œæœ€çµ‚ä¾æ“šã€‚</li>
                    </ul>
                </div>

                <div id="section-2-2">
                    <h3>(2) éƒ¨ç½²æ–¹å¼</h3>
                    <p>ä½¿ç”¨ <strong>Docker Container</strong> é€²è¡Œå¾®æœå‹™åŒ–éƒ¨ç½²ï¼š</p>
                    <ol>
                        <li><strong>Ollama Service</strong>: ä½¿ç”¨å®˜æ–¹ <code>ollama/ollama</code> Docker æ˜ åƒæª”ï¼Œæ›è¼‰ GPU (å¦‚æ”¯æ´) é€²è¡Œæœ¬åœ°æ¨è«–ã€‚</li>
                        <li><strong>API Wrapper</strong>: é–‹ç™¼ <code>llm_deploy.py</code> (åŸºæ–¼ FastAPI)ï¼Œä½œç‚ºçµ±ä¸€äººå·¥æ™ºæ…§ä»‹é¢å±¤ (<code>llm_client.py</code>)ã€‚
                            <ul>
                                <li>æ­¤å±¤è² è²¬è™•ç†ä¸åŒ Provider (Ollama/OpenAI/Gemini) çš„ API å·®ç•°ã€‚</li>
                                <li>é€éç’°å¢ƒè®Šæ•¸ (<code>LLM_PROVIDER</code>) å‹•æ…‹åˆ‡æ›å¾Œç«¯æ¨¡å‹ï¼Œç„¡éœ€ä¿®æ”¹ç¨‹å¼ç¢¼ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>Orchestration</strong>: ä½¿ç”¨ <code>docker-compose.llmkg.yml</code> å®šç¾©æœå‹™ä¾è³´èˆ‡ç¶²çµ¡ã€‚</li>
                    </ol>
                </div>

                <div id="section-2-3">
                    <h3>(3) éƒ¨ç½²é‡åˆ°çš„å•é¡Œèˆ‡è§£æ±º</h3>
                    <ul>
                        <li><strong>å•é¡Œ 1: JSON æ ¼å¼ç ´æ (Malformed JSON)</strong>
                            <ul>
                                <li><strong>ç‹€æ³</strong>: é–‹æºæ¨¡å‹ (DeepSeek R1 / Qwen 3) åœ¨ç‰¹å®šè¨­å®šä¸‹å¯èƒ½è¼¸å‡ºæ€è€ƒå…§å®¹ã€ä¸å®Œæ•´ JSON æˆ– Markdown è¨»é‡‹ï¼Œå°è‡´ <code>json.loads</code> å¤±æ•—ã€‚</li>
                                <li><strong>è§£æ±º</strong>: åœ¨ <code>kg_builder.py</code> å¯¦ä½œ <strong>Retry &amp; Repair Loop</strong>ã€‚å„ªå…ˆé€éæ¨¡å‹åƒæ•¸é—œé–‰/éš±è— thinkingï¼Œå†æ–¼è§£æå¤±æ•—æ™‚å›å‚³éŒ¯èª¤çµ¦ LLM è¦æ±‚ä¿®æ­£ JSONï¼Œæœ€å¤šé‡è©¦ 5 æ¬¡ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>å•é¡Œ 2: å›æ‡‰è¶…æ™‚ (Timeout)</strong>
                            <ul>
                                <li><strong>ç‹€æ³</strong>: è™•ç†é•·æ–‡æœ¬è²¡å ±æ™‚ï¼ŒLLM ç”Ÿæˆæ™‚é–“éé•·å°è‡´ HTTP 504 Gateway Timeoutã€‚</li>
                                <li><strong>è§£æ±º</strong>: å‰ç«¯æ”¹ç‚º <strong>Async Job + Polling</strong> æ©Ÿåˆ¶ã€‚ä¸Šå‚³æ–‡ä»¶å¾Œå›å‚³ Job IDï¼Œå‰ç«¯æ¯éš”å¹¾ç§’æŸ¥è©¢é€²åº¦ï¼Œé¿å…é•·é€£æ¥æ–·é–‹ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>å•é¡Œ 3: æ€ç¶­éˆ (Chain of Thought) å¹²æ“¾</strong>
                            <ul>
                                <li><strong>ç‹€æ³</strong>: éƒ¨åˆ†æ¨¡å‹åœ¨ thinking æ¨¡å¼ä¸‹å¯èƒ½è¼¸å‡ºé¡å¤–æ¨ç†å…§å®¹ï¼Œå¹²æ“¾ JSON çµæ§‹ã€‚</li>
                                <li><strong>è§£æ±º</strong>: å…ˆç”¨æ¨¡å‹åƒæ•¸é—œé–‰/éš±è— thinkingï¼ˆ<code>think=false</code> æˆ– <code>hidethinking</code>ï¼‰ï¼Œä¸¦åœ¨ Prompt ç¦æ­¢è¼¸å‡ºæ€è€ƒéç¨‹ï¼›å¾Œè™•ç† Regex æ¸…æ´—ä½œç‚ºæœ€å¾Œä¿éšªã€‚</li>
                            </ul>
                        </li>
                        <li><strong>å•é¡Œ 4: é•·æ–‡ä»¶é€ æˆè¨˜æ†¶é«”å£“åŠ›ï¼ˆOOM é¢¨éšªï¼‰</strong>
                            <ul>
                                <li><strong>ç‹€æ³</strong>: å–®æ¬¡æŠŠæ•´ä»½é•·æ–‡ä»¶ä¸Ÿå…¥æŠ½å–æµç¨‹ï¼Œæœƒæ”¾å¤§ token/è¨˜æ†¶é«”è² è¼‰ï¼Œåœ¨æœ¬åœ°æ©Ÿæˆ–å®¹å™¨è³‡æºæœ‰é™æ™‚å®¹æ˜“ä¸ç©©å®šã€‚</li>
                                <li><strong>è§£æ±º</strong>: åœ¨ <code>backend/logic.py</code> å°‡ Text/File/URL ingest æ”¹ç‚º <strong>chunk-first pipeline</strong>ï¼š
                                    <ul>
                                        <li>å…ˆä¾ provider åšåˆ‡å¡Šï¼šGemini é è¨­ token budgetï¼Œå…¶ä»– provider é è¨­ char budgetï¼ˆå¯ç”± <code>CHUNK_SIZE_MODE</code> å¼·åˆ¶åˆ‡æ›ï¼‰ã€‚</li>
                                        <li>å°è¶…é•·æ®µè½åšäºŒæ¬¡åˆ‡åˆ†ï¼ˆtoken overflow segment splitï¼‰ï¼Œé¿å…å–®å¡Šè¶…éä¸Šé™ã€‚</li>
                                        <li>é€ chunk æŠ½å–ä¸¦å¯«å…¥ KGï¼Œæ­é… <code>chunk_limit</code>/<code>INGEST_CHUNK_LIMIT</code> æ§åˆ¶å–®æ¬¡è™•ç†é‡ï¼Œé™ä½ OOM èˆ‡é•·è«‹æ±‚å¤±æ•—ç‡ã€‚</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section id="section-3">
                <h2>3. Domain Knowledge Graph å»ºç«‹è©³ç´°èªªæ˜</h2>

                <div id="section-3-step">
                    <h3>æ­¥é©Ÿèªªæ˜</h3>
                    <ul>
                        <li><strong>æ•¸æ“šä¾†æº</strong>: ä¼æ¥­è²¡å‹™å ±å‘Š (Financial Reports) èˆ‡æ–°èç¨¿ (ç¯„ä¾‹ï¼šé´»æµ·ã€å°ç©é›»)ã€‚</li>
                        <li><strong>Graph DB</strong>: é¸æ“‡ <strong>Neo4j (Community Edition v5)</strong>ã€‚</li>
                        <li><strong>å»ºç½®æµç¨‹</strong>: ä½¿ç”¨ <code>kg_builder.py</code> é€²è¡Œè‡ªå‹•åŒ–å»ºç½®ã€‚</li>
                        <li><strong>å¤§æª”è™•ç†ç­–ç•¥</strong>: é€é <code>backend/logic.py</code> å…ˆåš chunkingï¼ˆtoken/char budgetï¼‰ï¼Œå†é€å¡Šå‘¼å« <code>kg_builder.py</code> æŠ½å–èˆ‡ upsertï¼Œé¿å…å–®æ¬¡å¤§ä¸Šä¸‹æ–‡é€ æˆ OOMã€‚</li>
                    </ul>
                </div>

                <div id="section-3-0">
                    <h3>(0) å¯¦ä½œå°æ‡‰ï¼šå¯¦é«”/é—œä¿‚æŠ½å–èˆ‡ Neo4j å¯«å…¥</h3>
                    <ul>
                        <li><strong>æŠ½å–æ¡†æ¶</strong>: æœ¬å°ˆæ¡ˆä¸æ˜¯ä½¿ç”¨å‚³çµ± NER/RE å¥—ä»¶ï¼ˆå¦‚ spaCy stanzaï¼‰åšè¦å‰‡å¼æŠ½å–ï¼Œè€Œæ˜¯æ¡ç”¨ <code>kg_builder.py</code> çš„ <strong>LLM JSON æŠ½å–æµç¨‹</strong>ã€‚</li>
                        <li><strong>LLM å‘¼å«å±¤</strong>: ä½¿ç”¨è‡ªå»º <code>llm_client.py</code>ï¼ˆåº•å±¤å¥—ä»¶ç‚º <code>requests</code>ï¼‰çµ±ä¸€å‘¼å« <code>openai-compatible / ollama / gemini</code>ï¼Œå†ç”± Prompt ç´„æŸè¼¸å‡ºå›ºå®š JSON çµæ§‹ã€‚</li>
                        <li><strong>æŠ½å–ç­–ç•¥</strong>:
                            <ul>
                                <li>é è¨­ Single-passï¼šä¸€æ¬¡è¼¸å‡º <code>entities + relations</code>ã€‚</li>
                                <li>Gemini å¯å•Ÿç”¨ Two-passï¼ˆ<code>GEMINI_TWO_PASS_EXTRACTION=1</code>ï¼‰ï¼šå…ˆå¯¦é«”ç›¤é»ï¼Œå†ä»¥ seed entities æŠ½é—œä¿‚ï¼Œä¸¦å…ˆè£œé½Š KG ç¼ºæ¼å¯¦é«”å¾Œå†åšç¬¬äºŒéšæ®µé—œä¿‚æŠ½å–ã€‚</li>
                                <li>è§£æå¤±æ•—æ™‚æœ‰ Retry &amp; Repairï¼ˆæœ€å¤š 5 æ¬¡ï¼‰ä»¥ä¿®å¾© JSONã€‚</li>
                            </ul>
                        </li>
                        <li><strong>æŠ½å–å¾Œæ¸…æ´— (Post-processing)</strong>:
                            <ul>
                                <li>ä¾ç™½åå–®é™åˆ¶ entity/relation typeï¼ˆschema constraintsï¼‰ã€‚</li>
                                <li>åš alias/canonical name åˆä½µèˆ‡æ¨¡ç³Šæ¯”å°ï¼Œé™ä½åŒå¯¦é«”å¤šå¯«æ³•å•é¡Œã€‚</li>
                                <li>æª¢æŸ¥é—œä¿‚æ–¹å‘èˆ‡è²¡å ±å­£åº¦ä¸€è‡´æ€§ï¼ˆä¾‹å¦‚ <code>FOR_PERIOD</code> ä¸å…è¨±è·¨å­£åº¦èª¤é€£ï¼‰ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>Neo4j å¯«å…¥æ–¹å¼</strong>ï¼ˆ<code>neo4j</code> Python driverï¼‰:
                            <ol>
                                <li><code>_ensure_constraints()</code>ï¼šå»ºç«‹å”¯ä¸€éµèˆ‡ç´¢å¼•ï¼ˆ<code>Entity.name</code> uniqueã€<code>normalizedName</code> indexï¼‰ã€‚</li>
                                <li><code>_create_entity()</code>ï¼šä½¿ç”¨ <code>MERGE</code> upsert ç¯€é»ï¼Œç¯€é»åŒæ™‚å¸¶æœ‰å…·é«” labelï¼ˆå¦‚ <code>:Organization</code>ï¼‰èˆ‡å…±é€š <code>:Entity</code>ã€‚</li>
                                <li><code>_create_relation()</code>ï¼šä½¿ç”¨ <code>MERGE (a)-[:REL]-&gt;(b)</code> upsert é—œä¿‚ã€‚</li>
                                <li><code>populate_graph()</code>ï¼šé€ç­†å¯«å…¥ entities/relationsï¼Œå›å‚³çµ±è¨ˆï¼ˆupsert æ•¸ã€drop æ•¸ã€json retriesï¼‰ã€‚</li>
                            </ol>
                        </li>
                        <li><strong>æµç¨‹é‚Šç•Œèªªæ˜</strong>: <code>GraphCypherQAChain</code> å±¬æ–¼ <strong>NL2Cypher æŸ¥è©¢éšæ®µ</strong>ï¼ˆ<code>nl2cypher.py</code>ï¼‰ï¼Œä¸æ˜¯å¯¦é«”/é—œä¿‚æŠ½å–éšæ®µã€‚</li>
                    </ul>
                </div>

                <div id="section-3-1">
                    <h3>(1) åˆ©ç”¨ LLM å»ºç«‹ Knowledge Graph</h3>
                    <ul>
                        <li><strong>æ–¹æ³•</strong>: æ¡ç”¨ <strong>Two-Pass Extraction (å…©éšæ®µæŠ½å–æ³•)</strong>ã€‚
                            <ul>
                                <li><strong>Phase 1 (Entity Inventory)</strong>: å…ˆè®“ LLM æƒæå…¨æ–‡ï¼Œåˆ—å‡ºæ‰€æœ‰å¯¦é«” (Entities)ï¼Œé€²è¡Œæ¨™æº–åŒ– (Canonicalization)ã€‚</li>
                                <li><strong>Phase 2 (Relation Extraction)</strong>: å°‡ç¬¬ä¸€éšæ®µçš„å¯¦é«”æ¸…å–®ä½œç‚º Context é¤µçµ¦ LLMï¼Œè¦æ±‚å…¶æ‰¾å‡ºå¯¦é«”é–“çš„é—œä¿‚ (Relations)ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>é‡åˆ°çš„å•é¡Œèˆ‡è§£æ±º</strong>:
                            <ul>
                                <li><strong>å¯¦é«”æ­§ç¾© (Entity Ambiguity)</strong>: åŒä¸€å…¬å¸æœ‰å¤šç¨®å¯«æ³• (e.g., "é´»æµ·", "Hon Hai", "Foxconn")ã€‚
                                    <ul>
                                        <li><strong>è§£æ±º</strong>: å¯¦ä½œ <code>_resolve_entity_reference</code> èˆ‡ <code>SequenceMatcher</code> æ¨¡ç³Šæ¯”å°ï¼Œå°‡åˆ¥åæ˜ å°„åˆ°å–®ä¸€æ¨™æº–åç¨± (Canonical Name)ã€‚</li>
                                    </ul>
                                </li>
                                <li><strong>å¹»è¦ºé—œä¿‚ (Hallucinated Relations)</strong>: LLM å‰µé€ ä¸å­˜åœ¨çš„é—œä¿‚é¡å‹ã€‚
                                    <ul>
                                        <li><strong>è§£æ±º</strong>: è¨­å®š <strong>Schema Constraints (Ontology)</strong>ï¼Œåƒ…å…è¨±ç‰¹å®šçš„ Node Labels (e.g., <code>Organization</code>, <code>Person</code>) èˆ‡ Relation Types (e.g., <code>FOUNDED_BY</code>, <code>SUPPLIES_TO</code>)ï¼Œéæ¿¾æ‰ä¸ç¬¦åˆ Schema çš„è¼¸å‡ºã€‚</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div id="section-3-2">
                    <h3>(2) ä½¿ç”¨è€…å•é¡Œè½‰ Graph DB æŸ¥è©¢ (NL2Cypher)</h3>
                    <ul>
                        <li><strong>æ–¹æ³•</strong>: <code>nl2cypher.py</code> æ¡ <strong>é›™è·¯å¾‘ç­–ç•¥</strong>ï¼š
                            <ul>
                                <li><strong>Path A (LangChain)</strong>: ä½¿ç”¨ <code>GraphCypherQAChain + Neo4jGraph</code> ç›´æ¥å°‡è‡ªç„¶èªè¨€è½‰ Cypherï¼ˆéœ€å®‰è£ <code>langchain</code>/<code>langchain-community</code>ï¼Œä¸”ç›®å‰å¯¦ä½œé™åˆ¶ <code>LLM_PROVIDER=ollama</code>ï¼‰ã€‚</li>
                                <li><strong>Path B (Manual)</strong>: ä½¿ç”¨ <strong>Ministral 3 (14B)</strong> æ­é… <strong>Schema-Aware Prompting</strong> èˆ‡ä¿®å¾©é‡è©¦ï¼ˆself-correctionï¼‰æµç¨‹ã€‚</li>
                                <li>è‹¥ LangChain ä¾è³´æœªå®‰è£æˆ– provider ä¸ç¬¦ï¼Œæœƒè‡ªå‹• fallback åˆ° Manual è·¯å¾‘ï¼Œç¢ºä¿æŸ¥è©¢æµç¨‹ä¸ä¸­æ–·ã€‚</li>
                                <li>Manual è·¯å¾‘æœƒå°‡ Graph Schema (ç¯€é»é¡å‹ã€é—œä¿‚ã€å±¬æ€§) æ³¨å…¥ Promptï¼Œä¸¦ç”¨ Few-Shot Examples å¼•å° Cypher ç”Ÿæˆã€‚</li>
                            </ul>
                        </li>
                    </ul>

                    <h4>ä½¿ç”¨ <code>GraphCypherQAChain</code> çš„å¥½è™•ï¼ˆå®˜æ–¹æ–‡ä»¶å°æ‡‰ï¼‰</h4>
                    <ul>
                        <li><strong>ç«¯åˆ°ç«¯æµç¨‹å…§å»º</strong>ï¼šå¯ç›´æ¥å®Œæˆã€Œè‡ªç„¶èªè¨€å•é¡Œ -> ç”¢ç”Ÿ Cypher -> æŸ¥ Neo4j -> ç”Ÿæˆç­”æ¡ˆã€ï¼Œæ¸›å°‘è‡ªè¡Œä¸²æ¥ prompt/executor/answerer çš„æ¨£æ¿ç¨‹å¼ã€‚</li>
                        <li><strong>Schema å°å‘ï¼Œé™ä½äº‚ç”ŸæŸ¥è©¢</strong>ï¼šå®˜æ–¹æ•´åˆæ–‡ä»¶ç¤ºç¯„ä»¥åœ–è­œ schema ç”Ÿæˆ Cypherï¼Œä¸”å¯ <code>refresh_schema()</code>ï¼›<code>enhanced_schema=True</code> æœƒè‡ªå‹•æƒææ¨£æœ¬å€¼èˆ‡åˆ†ä½ˆè³‡è¨Šï¼Œè®“ç”Ÿæˆæ›´è²¼è¿‘å¯¦éš›è³‡æ–™ã€‚</li>
                        <li><strong>å¯è§€æ¸¬æ€§é«˜ï¼Œä¾¿æ–¼é™¤éŒ¯</strong>ï¼š<code>return_intermediate_steps=True</code> å¯æ‹¿åˆ°ã€Œç”Ÿæˆçš„ Cypher + æŸ¥è©¢ contextã€ï¼Œæ–¹ä¾¿è¿½è¹¤éŒ¯èª¤èˆ‡å»ºç«‹ç¨½æ ¸ç´€éŒ„ã€‚</li>
                        <li><strong>çµæœå¯æ§ï¼Œé¿å…éé‡å›å‚³</strong>ï¼š<code>top_k</code> å¯é™åˆ¶å›å‚³ç­†æ•¸ï¼ˆå®˜æ–¹é è¨­ 10ï¼‰ï¼Œ<code>return_direct=True</code> å¯ç›´æ¥æ‹¿è³‡æ–™åˆ—ï¼Œæ–¹ä¾¿ä¸‹æ¸¸ API/å‰ç«¯è‡ªè¡Œæ ¼å¼åŒ–ã€‚</li>
                        <li><strong>å¯å®¢è£½ Cypher ç”Ÿæˆå“è³ª</strong>ï¼šå¯é€é <code>cypher_prompt</code> æ³¨å…¥ few-shot ç¯„ä¾‹ï¼›äº¦å¯åˆ†é›¢ <code>cypher_llm</code> èˆ‡ <code>qa_llm</code>ï¼Œåˆ†åˆ¥å„ªåŒ–ã€ŒæŸ¥è©¢ç”Ÿæˆã€èˆ‡ã€Œç­”æ¡ˆæ•˜è¿°ã€ã€‚</li>
                        <li><strong>å¯é™åˆ¶ schema å­é›†ï¼Œæ¸›å°‘èª¤æŸ¥</strong>ï¼š<code>include_types</code> / <code>exclude_types</code> å¯åœ¨ç”Ÿæˆéšæ®µæ’é™¤ç‰¹å®šç¯€é»æˆ–é—œä¿‚ï¼Œç¸®å°æŸ¥è©¢ç©ºé–“ã€‚</li>
                        <li><strong>å¯åšé—œä¿‚æ–¹å‘æ ¡æ­£</strong>ï¼š<code>validate_cypher=True</code> å¯é©—è­‰ä¸¦ä¿®æ­£é—œä¿‚æ–¹å‘ï¼Œé™ä½å› æ–¹å‘éŒ¯èª¤å°è‡´çš„ç©ºçµæœæˆ–éŒ¯èª¤æŸ¥è©¢ã€‚</li>
                        <li><strong>å¯ç”¨ function/tool response å¼·åŒ–ç­”æ¡ˆè²¼åœ°æ€§</strong>ï¼š<code>use_function_response=True</code> æœƒä»¥å·¥å…·è¼¸å‡ºæ–¹å¼æä¾›è³‡æ–™åº« contextï¼Œå®˜æ–¹æ–‡ä»¶æ˜ç¢ºæŒ‡å‡ºå¯æå‡ç­”æ¡ˆæº–ç¢ºæ€§èˆ‡ç›¸é—œæ€§ï¼ˆéœ€æ¨¡å‹æ”¯æ´ function callingï¼‰ã€‚</li>
                    </ul>

                    <p><strong>å®˜æ–¹ä¾†æºï¼ˆLangChainï¼‰</strong></p>
                    <ol>
                        <li>Neo4j integrationï¼š<a href="https://docs.langchain.com/oss/python/integrations/graphs/neo4j_cypher" target="_blank">https://docs.langchain.com/oss/python/integrations/graphs/neo4j_cypher</a></li>
                        <li>GraphCypherQAChain API Referenceï¼š<a href="https://api.python.langchain.com/en/latest/community/chains/langchain_community.chains.graph_qa.cypher.GraphCypherQAChain.html" target="_blank">https://api.python.langchain.com/en/latest/community/chains/langchain_community.chains.graph_qa.cypher.GraphCypherQAChain.html</a></li>
                        <li>LangChain Securityï¼š<a href="https://docs.langchain.com/oss/python/security-policy" target="_blank">https://docs.langchain.com/oss/python/security-policy</a></li>
                    </ol>

                    <blockquote>å®‰å…¨è¨»è¨˜ï¼ˆå®˜æ–¹ï¼‰ï¼š<code>GraphCypherQAChain</code> éœ€æ˜ç¢º <code>allow_dangerous_requests=True</code> æ‰å¯åŸ·è¡Œï¼Œä¸”å®˜æ–¹è¦æ±‚è³‡æ–™åº«å¸³è™Ÿå¿…é ˆä½¿ç”¨æœ€å°æ¬Šé™ï¼ˆnarrowly-scoped credentialsï¼‰ã€‚</blockquote>

                    <ul>
                        <li><strong>é‡åˆ°çš„å•é¡Œèˆ‡è§£æ±º</strong>:
                            <ul>
                                <li><strong>èªæ³•éŒ¯èª¤ (Syntax Error)</strong>: ç”Ÿæˆçš„ Cypher ç„¡æ³•åŸ·è¡Œã€‚
                                    <ul>
                                        <li><strong>è§£æ±º</strong>: å¯¦ä½œ <strong>Self-Correction Loop</strong>ã€‚æ•æ‰ Neo4j éŒ¯èª¤è¨Šæ¯ï¼Œå°‡éŒ¯èª¤å›å‚³çµ¦ LLM è¦æ±‚ä¿®æ­£ (Retry up to 3 times)ã€‚</li>
                                    </ul>
                                </li>
                                <li><strong>èªæ„ä¸æ¸…</strong>: ä½¿ç”¨è€…å•ã€Œè‘£äº‹é•·ã€ä½† Schema åªæœ‰ <code>CHAIRED_BY</code> é—œä¿‚ã€‚
                                    <ul>
                                        <li><strong>è§£æ±º</strong>: åœ¨ System Prompt ä¸­åŠ å…¥ <strong>Semantic Mapping Rules</strong> (e.g., "è‘£äº‹é•·" maps to <code>CHAIRED_BY</code> relationship)ã€‚</li>
                                    </ul>
                                </li>
                                <li><strong>è²¡å ±æ•¸æ“šé€ å‡</strong>: LLM å‚¾å‘ç›´æ¥ç”Ÿæˆæ•¸å­—è€ŒéæŸ¥è©¢è³‡æ–™åº«ã€‚
                                    <ul>
                                        <li><strong>è§£æ±º</strong>: åŠ å…¥ <strong>Guardrails</strong>ï¼Œæª¢æ¸¬ Cypher æ˜¯å¦åŒ…å« <code>AS revenue</code> ç­‰ç¡¬ç·¨ç¢¼å¸¸æ•¸ï¼Œè‹¥ç™¼ç¾å‰‡å¼·åˆ¶ä½¿ç”¨é å®šç¾©çš„ Template Query æŸ¥è©¢çœŸå¯¦è·¯å¾‘ã€‚</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div id="section-3-3">
                    <h3>(3) é¸æ“‡ Neo4j çš„åŸå› èˆ‡æ¯”è¼ƒ</h3>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>åœ–è³‡æ–™åº« (Graph DB)</th>
                                    <th>ç‰¹é»èˆ‡å„ªå‹¢ (Pros)</th>
                                    <th>åŠ£å‹¢èˆ‡é™åˆ¶ (Cons)</th>
                                    <th>æœ¬å°ˆæ¡ˆé©ç”¨æ€§åˆ†æ (Verdict)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Neo4j</strong> (æœ¬å°ˆæ¡ˆæ¡ç”¨)</td>
                                    <td>1. <strong>æˆç†Ÿåº¦é«˜</strong>ï¼šå¸‚å ´ä½”æœ‰ç‡æœ€é«˜ï¼Œç¤¾ç¾¤è³‡æºæœ€è±å¯Œã€‚<br>2. <strong>æŸ¥è©¢èªè¨€</strong>ï¼šCypher ç›´è§€ä¸”é¡ä¼¼ SQLï¼Œæ˜“æ–¼ LLM å­¸ç¿’èˆ‡ç”Ÿæˆã€‚<br>3. <strong>è¦–è¦ºåŒ–å¼·</strong>ï¼šå…§å»º Neo4j Browser èˆ‡ Bloomï¼Œæ–¹ä¾¿é™¤éŒ¯ã€‚</td>
                                    <td>å¤§è¦æ¨¡åˆ†æ•£å¼é‹ç®—éœ€ä¼æ¥­ç‰ˆæ”¯æ´ï¼›å¯«å…¥ååé‡åœ¨æ¥µç«¯å ´æ™¯ä¸‹å¯èƒ½ä¸å¦‚å°ˆé–€çš„åˆ†æ•£å¼åœ–è³‡æ–™åº«ã€‚</td>
                                    <td><strong>æœ€ä½³é¸æ“‡</strong><br>é©åˆæœ¬å°ˆæ¡ˆçš„ä¸­å°å‹è¦æ¨¡ï¼ŒDocker éƒ¨ç½²ç°¡å–®ï¼Œä¸” Cypher å° LLM æœ€å‹å–„ã€‚</td>
                                </tr>
                                <tr>
                                    <td><strong>TigerGraph</strong></td>
                                    <td><strong>åˆ†æ•£å¼é‹ç®—å¼·</strong>ï¼šé©åˆè¶…å¤§è¦æ¨¡ (TBç´š) æ•¸æ“šåˆ†æã€‚</td>
                                    <td><strong>å­¸ç¿’æ›²ç·šé™¡</strong>ï¼šGSQL è¼ƒè¤‡é›œã€‚<br><strong>ç¤¾ç¾¤ç‰ˆé™åˆ¶</strong>ï¼šåŠŸèƒ½èˆ‡é™åˆ¶è¼ƒå¤šã€‚</td>
                                    <td><strong>ä¸é©åˆ</strong><br>æœ¬å°ˆæ¡ˆè¦æ¨¡æœªé” TB ç´šï¼Œä¸” Neo4j å°æ–¼ä¸­å°å‹è¦æ¨¡æ›´æ˜“æ–¼ä¸Šæ‰‹èˆ‡éƒ¨ç½²ã€‚</td>
                                </tr>
                                <tr>
                                    <td><strong>ArangoDB</strong></td>
                                    <td><strong>å¤šæ¨¡è³‡æ–™åº« (Multi-model)</strong>ï¼šåŒæ™‚æ”¯æ´ Document, Key-Value, Graphï¼Œéˆæ´»æ€§é«˜ã€‚</td>
                                    <td><strong>éåŸç”Ÿåœ–è³‡æ–™åº«</strong>ï¼šåœ¨ç´”åœ–æ¼”ç®—æ³•èˆ‡æ·±åº¦éæ­·æ•ˆèƒ½ä¸Šé€šå¸¸ä¸å¦‚åŸç”Ÿçš„ Neo4jã€‚</td>
                                    <td><strong>ä¸é©åˆ</strong><br>æœ¬å°ˆæ¡ˆå°ˆæ³¨æ–¼è¤‡é›œé—œä¿‚éˆæŸ¥è©¢ï¼ŒåŸç”Ÿåœ–è³‡æ–™åº« (Native Graph DB) è¼ƒç‚ºåˆé©ã€‚</td>
                                </tr>
                                <tr>
                                    <td><strong>NebulaGraph</strong></td>
                                    <td><strong>å¯«å…¥ååé‡é«˜</strong>ï¼šé‡å°æµ·é‡æ•¸æ“šè¨­è¨ˆçš„é–‹æºåˆ†ä½ˆå¼åœ–è³‡æ–™åº«ã€‚</td>
                                    <td><strong>éƒ¨ç½²è¤‡é›œ</strong>ï¼šåœ¨å–®æ©Ÿé–‹ç™¼ç’°å¢ƒçš„è¼•é‡ç´šéƒ¨ç½²ä¸Šï¼Œé…ç½®è¼ƒ Neo4j ç¹ç‘£ã€‚</td>
                                    <td><strong>å‚™é¸</strong><br>Docker ç‰ˆçš„ Neo4j é…ç½®è¼ƒç‚ºç°¡å–®ï¼Œç¬¦åˆç›®å‰å¿«é€Ÿé–‹ç™¼éœ€æ±‚ã€‚</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="section-4">
                <h2>4. OpenClaw ç³»çµ±æ¶æ§‹èˆ‡æŠ€èƒ½å®‰å…¨åˆ†æ</h2>

                <div id="section-4-1">
                    <h3>(1) OpenClaw ç³»çµ±æ¶æ§‹èˆ‡ä¸»è¦çµ„ä»¶</h3>
                    <p>ä»¥ä¸‹ä¾ <code>ARCHITECTURE.md</code> å½™æ•´ï¼š</p>
                    <ul>
                        <li><strong>Gateway Server (<code>src/gateway</code>)</strong>ï¼š
                            <ul>
                                <li>ä»¥å¾®æ ¸å¿ƒæ¶æ§‹ç‚ºä¸­æ¨ï¼Œè² è²¬é…ç½®è¼‰å…¥ã€Plugin æ›è¼‰ã€HTTP/WebSocket æœå‹™ã€äº‹ä»¶å»£æ’­èˆ‡å­æœå‹™ç”Ÿå‘½é€±æœŸã€‚</li>
                                <li>å…§å« Discoveryã€Tailscaleã€Exec Approval Manager ç­‰é—œéµèƒ½åŠ›ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>Channel System (<code>src/channels</code>)</strong>ï¼š
                            <ul>
                                <li>å°‡ WhatsApp / Telegram / Discord / Slack ç­‰ç•°è³ªè¨Šæ¯æ¨™æº–åŒ–ï¼Œçµ±ä¸€è¼¸å…¥äº‹ä»¶æ ¼å¼ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>Auto-reply Engine (<code>src/auto-reply</code>)</strong>ï¼š
                            <ul>
                                <li>è² è²¬è¨Šæ¯è·¯ç”±ã€Session ç®¡ç†ã€æ¨¡å‹é¸æ“‡ã€ReAct å·¥å…·è¿´åœˆåŸ·è¡Œèˆ‡æœ€çµ‚å›è¦†ç”Ÿæˆã€‚</li>
                            </ul>
                        </li>
                        <li><strong>Plugin / Skill ç”Ÿæ…‹ (<code>extensions/</code>, <code>skills/</code>)</strong>ï¼š
                            <ul>
                                <li>é€éå¤–æ›æ“´å…… Channelã€Toolsã€CLI æŒ‡ä»¤èˆ‡ HTTP Routesï¼Œæ˜¯å¹³å°æ“´å±•æ€§æ ¸å¿ƒã€‚</li>
                            </ul>
                        </li>
                        <li><strong>åŸºç¤è¨­æ–½å±¤ (<code>src/cron</code>, <code>src/media</code>)</strong>ï¼š
                            <ul>
                                <li>æä¾›æ’ç¨‹ã€åª’é«”è½‰æ›ã€çŸ­æœŸæª”æ¡ˆæœå‹™èˆ‡æ¸…ç†æ©Ÿåˆ¶ã€‚</li>
                            </ul>
                        </li>
                    </ul>

                    <p><strong>è³‡æ–™æµï¼ˆData Flowï¼Œå¼•ç”¨ <code>ARCHITECTURE.md</code>ï¼‰</strong></p>

                    <h4>4.1 è¨Šæ¯è™•ç†æµç¨‹</h4>
                    <div class="mermaid">sequenceDiagram
    participant User
    participant ChannelPlugin as Channel Plugin
    participant Gateway
    participant Dispatcher
    participant AgentRunner
    participant LLM

    User->>ChannelPlugin: ç™¼é€è¨Šæ¯
    ChannelPlugin->>Gateway: æ¨™æº–åŒ–è¨Šæ¯ (Normalized Event)
    Gateway->>Dispatcher: dispatchInboundMessage()

    note over Dispatcher: Security Check (Command Gating)

    Dispatcher->>Dispatcher: å»ºç«‹ MsgContext
    Dispatcher->>AgentRunner: è§¸ç™¼ Agent åŸ·è¡Œ

    loop Thinking Process
        AgentRunner->>LLM: ç™¼é€ Prompt + Context
        LLM-->>AgentRunner: å›å‚³ Thought / Tool Call
        opt Tool Execution
            AgentRunner->>Gateway: åŸ·è¡Œå·¥å…· (e.g., search, query)
            Gateway-->>AgentRunner: å›å‚³ Tool Result
        end
    end

    AgentRunner-->>Dispatcher: ç”Ÿæˆæœ€çµ‚å›è¦† (Payload)
    Dispatcher->>ChannelPlugin: ç™¼é€å›è¦†
    ChannelPlugin->>User: é¡¯ç¤ºè¨Šæ¯
</div>

                    <h4>4.2 Agent æ€è€ƒéç¨‹è©³è§£ (Agent Execution Loop)</h4>
                    <p>Agent çš„åŸ·è¡Œé‚è¼¯ä½æ–¼ <code>src/auto-reply/reply/agent-runner.ts</code> èˆ‡ <code>agent-runner-execution.ts</code>ï¼Œå…¶æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š</p>
                    <ol>
                        <li><strong>ä¸Šä¸‹æ–‡æº–å‚™ (Context Prep)</strong>ï¼š
                            <ul>
                                <li>å¾ Session Store è¼‰å…¥å°è©±æ­·å²ã€‚</li>
                                <li>æ³¨å…¥ç³»çµ±æç¤ºè© (System Prompt) èˆ‡ç•¶å‰å¯ç”¨å·¥å…· (Tools)ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>æ¬Šé™æª¢æŸ¥ (Security)</strong>ï¼š
                            <ul>
                                <li><strong>Command Gating</strong>ï¼šæª¢æŸ¥ç™¼é€è€…æ˜¯å¦åœ¨å…è¨±æ¸…å–® (Allowlist) ä¸­ï¼Œä»¥æ±ºå®šæ˜¯å¦åŸ·è¡Œæ•æ„ŸæŒ‡ä»¤ã€‚</li>
                                <li><strong>Access Groups</strong>ï¼šæ”¯æ´ç¾¤çµ„å±¤ç´šçš„æ¬Šé™ç®¡ç†ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>æ¨¡å‹èª¿ç”¨ (Model Invocation)</strong>ï¼š
                            <ul>
                                <li>å°‡ä¸Šä¸‹æ–‡ç™¼é€è‡³é…ç½®çš„ LLM (OpenAI, Anthropic ç­‰)ã€‚</li>
                                <li>è‹¥é…ç½®äº† Fallbackï¼Œç•¶ä¸»è¦æ¨¡å‹å¤±æ•—æ™‚æœƒè‡ªå‹•åˆ‡æ›è‡³å‚™æ´æ¨¡å‹ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>æ¨ç†èˆ‡å·¥å…· (Reasoning &amp; Tools)</strong>ï¼š
                            <ul>
                                <li><strong>Thinking</strong>ï¼šAgent ç”¢ç”Ÿæ€è€ƒéç¨‹ (CoT)ã€‚</li>
                                <li><strong>Action</strong>ï¼šè‹¥ Agent æ±ºå®šä½¿ç”¨å·¥å…·ï¼Œç³»çµ±æœƒæ””æˆª Tool Callï¼ŒåŸ·è¡Œå°æ‡‰çš„ TypeScript å‡½æ•¸ï¼Œä¸¦å°‡çµæœ (Observation) é™„åŠ å›å°è©±æ­·å²ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>ä¸²æµå›æ‡‰ (Streaming)</strong>ï¼š
                            <ul>
                                <li>æ”¯æ´ <strong>Block Streaming</strong>ï¼Œå³æ™‚å°‡ Agent çš„éƒ¨åˆ†æ€è€ƒæˆ–å›æ‡‰æ¨é€çµ¦ä½¿ç”¨è€…ï¼Œæ¸›å°‘ç­‰å¾…æ„Ÿã€‚</li>
                                <li>è™•ç† <strong>Typing Indicators</strong>ï¼Œåœ¨ Agent æ€è€ƒæˆ–åŸ·è¡Œå·¥å…·æ™‚é¡¯ç¤ºã€Œæ­£åœ¨è¼¸å…¥...ã€ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>è¨˜æ†¶é«”ç®¡ç† (Memory Management)</strong>ï¼š
                            <ul>
                                <li>åŸ·è¡Œå¾Œè‡ªå‹•æª¢æŸ¥ Context Windowï¼Œå¿…è¦æ™‚è§¸ç™¼ <strong>Compaction</strong>ï¼ˆæ‘˜è¦/å£“ç¸®æ­·å²ç´€éŒ„ï¼‰ã€‚</li>
                            </ul>
                        </li>
                    </ol>

                    <h4>4.3 åª’é«”è™•ç†ç®¡é“ (Media Pipeline)</h4>
                    <p>ä½æ–¼ <code>src/media/</code>ï¼Œè² è²¬è™•ç†åœ–ç‰‡ã€éŸ³è¨Šèˆ‡å½±ç‰‡æª”æ¡ˆã€‚</p>
                    <ul>
                        <li><strong>æš«å­˜ä¼ºæœå™¨ (Ephemeral Server)</strong>ï¼šå•Ÿå‹•ä¸€å€‹ Express Server æä¾›æœ¬åœ°åª’é«”æª”æ¡ˆçš„ HTTP å­˜å–ã€‚</li>
                        <li><strong>ç”Ÿå‘½é€±æœŸç®¡ç†</strong>ï¼šä¸Šå‚³çš„åª’é«”æª”æ¡ˆé è¨­æœ‰ TTL (Time-To-Liveï¼Œä¾‹å¦‚ 2 åˆ†é˜)ï¼ŒéæœŸå¾Œæœƒç”± <code>cleanOldMedia</code> å®šæœŸæ¸…ç†ï¼Œç¢ºä¿ç£ç¢Ÿç©ºé–“ä¸è¢«ä½”ç”¨ã€‚</li>
                        <li><strong>MIME åµæ¸¬</strong>ï¼šä½¿ç”¨ <code>detectMime</code> è‡ªå‹•è­˜åˆ¥æª”æ¡ˆé¡å‹ã€‚</li>
                    </ul>
                </div>

                <div id="section-4-2">
                    <h3>(2) OpenClaw å®‰å…¨é¢¨éšªï¼ˆ3 å¤§é¡ 10 é …ï¼‰</h3>

                    <h4>A. Skill ç”Ÿæ…‹ç³»é¢¨éšªï¼ˆ5 é …ï¼Œæœ€é«˜å„ªå…ˆï¼‰</h4>
                    <ol>
                        <li><strong>ä»»æ„ç¨‹å¼ç¢¼åŸ·è¡Œ (RCE)</strong>ï¼šSkill é€é <code>eval</code> / shell pipe / <code>child_process</code> åŸ·è¡Œæƒ¡æ„æŒ‡ä»¤ã€‚</li>
                        <li><strong>è·¯å¾‘éæ­· (Path Traversal)</strong>ï¼šæƒ¡æ„è·¯å¾‘ï¼ˆå¦‚ <code>../../etc/passwd</code>ï¼‰è®€å–è¶…å‡ºæˆæ¬Šç¯„åœæª”æ¡ˆã€‚</li>
                        <li><strong>è³‡æ–™å¤–æ´© (Exfiltration)</strong>ï¼šSkill è®€å–æœ¬æ©Ÿæ•æ„Ÿæª”å¾Œé€éç¶²è·¯ä¸Šå‚³åˆ°å¤–éƒ¨ç«¯é»ã€‚</li>
                        <li><strong>ä¾›æ‡‰éˆæ”»æ“Š (Supply Chain Poisoning)</strong>ï¼šæƒ¡æ„ Skill å½è£å¯¦ç”¨å·¥å…·æ··å…¥ç”Ÿæ…‹ã€‚</li>
                        <li><strong>Prompt Injection via Skill Output</strong>ï¼šSkill è¼¸å‡ºå¤¾å¸¶æƒ¡æ„æŒ‡ä»¤ï¼Œèª˜å° Agent è¦†å¯«å®‰å…¨é‚Šç•Œã€‚</li>
                    </ol>

                    <h4>B. åŸ·è¡Œç’°å¢ƒé¢¨éšªï¼ˆ3 é …ï¼‰</h4>
                    <ol start="6">
                        <li><strong>æ²™ç®±é€ƒé€¸ (Sandbox Escape)</strong>ï¼švm/å®¹å™¨éš”é›¢ä¸è¶³æ™‚ï¼Œæƒ¡æ„ç¨‹å¼çªç ´åŸ·è¡Œé‚Šç•Œã€‚</li>
                        <li><strong>éåº¦é«˜æ¬Šé™åŸ·è¡Œ</strong>ï¼šSkill ç›´æ¥å–å¾—éå¤§ç³»çµ±æ¬Šé™ï¼ˆæª”æ¡ˆã€ç¶²è·¯ã€å‘½ä»¤åŒæ™‚é–‹æ”¾ï¼‰ã€‚</li>
                        <li><strong>èŠå¤©è¨Šæ¯æ³¨å…¥å‘é‡</strong>ï¼šå¤–éƒ¨è¨Šæ¯ç›´æ¥æ‹¼æ¥åˆ°é«˜æ¬Šé™å·¥å…· prompt/å‘½ä»¤ï¼Œé€ æˆé–“æ¥æ³¨å…¥ã€‚</li>
                    </ol>

                    <h4>C. ç³»çµ±æ•´åˆèˆ‡æ²»ç†é¢¨éšªï¼ˆ2 é …ï¼‰</h4>
                    <ol start="9">
                        <li><strong>æ¬Šé™ç²’åº¦ä¸è¶³</strong>ï¼šç¼ºå°‘ capability ç´šåˆ¥æˆæ¬Šï¼Œç„¡æ³•æœ€å°æ¬Šé™åŒ–ã€‚</li>
                        <li><strong>Token/Secrets ç®¡ç†ä¸è¶³</strong>ï¼šç¬¬ä¸‰æ–¹ API Token è‹¥æœªåŠ å¯†ã€æœªè¼ªæ›¿ã€ç¼ºç¨½æ ¸ï¼Œå¤–æ´©é¢¨éšªé«˜ã€‚</li>
                    </ol>

                    <p><strong>ç¾æ³è§€å¯Ÿï¼ˆæœ¬ repoï¼‰</strong>ï¼š</p>
                    <ul>
                        <li>å·²æœ‰ <code>genai_project/openclaw/security/skill_audit.ts</code>ï¼Œå¯æŠ“åˆ° <code>curl|bash</code>ã€<code>eval</code>ã€<code>sudo</code>ã€<code>elevated:true</code> ç­‰é«˜é¢¨éšªæ¨¡å¼ã€‚</li>
                        <li>ç›®å‰å±¬æ–¼ <strong>éœæ…‹ Regex åŸºç·šæª¢æŸ¥</strong>ï¼Œå°šæœªè¦†è“‹ AST è¡Œç‚ºåˆ†æã€æ²™ç®±å‹•æ…‹é©—è­‰ã€ä¾†æºç°½ç« èˆ‡å®Œæ•´æ¬Šé™æ”¿ç­–ã€‚</li>
                    </ul>
                </div>

                <div id="section-4-3">
                    <h3>(3) æŠ€èƒ½å®‰å…¨å¯©æŸ¥æ©Ÿåˆ¶è¨­è¨ˆï¼ˆå»ºè­°è½åœ°ç‰ˆï¼‰</h3>

                    <h4>3.1 å››éšæ®µå¯©æŸ¥ç¸½è¦½ï¼ˆä¸Šæ¶å‰ï¼‰</h4>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Phase</th>
                                    <th>åç¨±</th>
                                    <th>æ ¸å¿ƒæ–¹æ³•</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td><strong>Manifest Audit</strong></td>
                                    <td>å¿…è¦æ¬„ä½é©—è­‰ã€æ¬Šé™ç™½åå–®æ¯”å°ã€sandbox å¼·åˆ¶é™åˆ¶</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td><strong>Static Analysis</strong></td>
                                    <td>å±éšª API Regex/è¦å‰‡æƒæ + æ··æ·†åµæ¸¬ï¼ˆé•·è¡Œã€Hex/Unicode è·³è„«ï¼‰</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td><strong>Sandbox Trial</strong></td>
                                    <td>å—æ§åŸ·è¡Œã€ç¶²è·¯æ””æˆªã€ç³»çµ±å‘¼å«ç›£æ§ã€è³‡æºä¸Šé™</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td><strong>Signature Verification</strong></td>
                                    <td><code>SHA-256(manifest + entrypoint)</code> + ç™¼å¸ƒè€…å…¬é‘°ï¼ˆRSA/ç­‰æ•ˆï¼‰é©—è­‰</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <p><strong>æ±ºç­–é‚è¼¯</strong></p>
                    <ul>
                        <li>æœ‰ <code>CRITICAL/ERROR</code>ï¼šè‡ªå‹•æ‹’çµ•ã€‚</li>
                        <li>æœ‰ <code>HIGH/WARN</code>ï¼šè½‰äººå·¥è¤‡å¯©ã€‚</li>
                        <li>å…¨é€šéä¸”ç°½ç« æœ‰æ•ˆï¼šå…è¨±ä¸Šæ¶ã€‚</li>
                    </ul>

                    <h4>3.2 Phase 1ï¼šManifest Auditï¼ˆæ¸…å–®å¯©æŸ¥ï¼‰</h4>
                    <p>å…ˆå¯©æŸ¥ Skill çš„ <code>skill.json</code>ï¼ˆè‡ªæˆ‘è²æ˜ï¼‰ï¼Œä¸åˆè¦ç›´æ¥æ“‹ä¸‹ï¼Œä¸é€²ä¸‹ä¸€é—œã€‚</p>

                    <p><strong>å¿…è¦æ¬„ä½é©—è­‰</strong></p>
                    <pre><code class="language-json">{
  "name": "file_summarizer",
  "version": "1.0.0",
  "author": "demo-author",
  "permissions": ["fs.read.whitelist"],
  "entrypoint": "index.js",
  "sandbox": {
    "exec": false,
    "network": false,
    "fs_read": ["/home/user/documents"],
    "fs_write": []
  }
}</code></pre>

                    <p><strong>æ¬Šé™ç™½åå–®æ¯”å°</strong></p>
                    <ul>
                        <li>å…è¨±ï¼š<code>system.time</code>ã€<code>fs.read.whitelist</code>ã€<code>network.outbound.allowlist</code></li>
                        <li>æ‹’çµ•ï¼š<code>system.root</code>ã€<code>fs.read.*</code>ã€<code>exec.shell</code></li>
                    </ul>

                    <p><strong>Sandbox å¼·åˆ¶è¦å‰‡</strong></p>
                    <ul>
                        <li><code>sandbox.exec=true</code>ï¼šç›´æ¥ <code>CRITICAL</code>ï¼ˆæ‹’çµ•ï¼‰ã€‚</li>
                        <li><code>sandbox.network=true</code> ä½†æœªå®£å‘Šå°æ‡‰ç¶²è·¯æ¬Šé™ï¼š<code>ERROR</code>ï¼ˆæ‹’çµ•ï¼‰ã€‚</li>
                        <li><code>fs_read/fs_write</code> å¿…é ˆæ˜¯æ˜ç¢ºç™½åå–®è·¯å¾‘ã€‚</li>
                    </ul>

                    <h4>3.3 Phase 2ï¼šStatic Analysisï¼ˆéœæ…‹æƒæï¼‰</h4>
                    <p>ä¸åŸ·è¡Œç¨‹å¼ï¼Œç›´æ¥æƒæåŸå§‹ç¢¼æ¨¡å¼ã€‚</p>

                    <p><strong>å±éšª API é¢¨éšªåˆ†ç´š</strong></p>
                    <ul>
                        <li><code>CRITICAL</code>ï¼š<code>child_process</code>ã€<code>exec()</code>ã€<code>execSync</code>ã€<code>spawn()</code>ã€<code>eval()</code>ã€<code>new Function()</code></li>
                        <li><code>HIGH</code>ï¼šæœªæˆæ¬Šç¶²è·¯å‘¼å«ï¼ˆ<code>http/https/fetch</code>ï¼‰ã€æª”æ¡ˆç ´å£æ“ä½œï¼ˆ<code>fs.writeFile/fs.unlink/fs.rmdir</code>ï¼‰</li>
                        <li><code>MEDIUM</code>ï¼š<code>process.env</code>ã€<code>process.exit()</code>ã€å¯ç–‘è§£ç¢¼ï¼ˆ<code>Buffer.from(base64)</code>ï¼‰</li>
                        <li><code>LOW</code>ï¼šHex/Unicode è·³è„«å­—ä¸²ã€éåº¦æ··æ·†ç—•è·¡</li>
                    </ul>

                    <p><strong>æ··æ·†åµæ¸¬</strong></p>
                    <ul>
                        <li>å–®è¡Œè¶…é 500 å­—å…ƒè§¸ç™¼è­¦ç¤ºï¼ˆå¸¸è¦‹æ–¼æ··æ·†æˆ–æƒ¡æ„ payloadï¼‰ã€‚</li>
                        <li>åµæ¸¬ <code>\xNN</code>ã€<code>\uNNNN</code> å¤§é‡è·³è„«å­—å…ƒã€‚</li>
                    </ul>

                    <p><strong>é™åˆ¶èªªæ˜ï¼ˆéœ€æ­é… Phase 3ï¼‰</strong></p>
                    <pre><code class="language-javascript">const mod = "child" + "_" + "process";
require(mod).exec("rm -rf /");</code></pre>
                    <p>ä¸Šè¿°å‹•æ…‹çµ„å­—å¯èƒ½ç¹éç´”å­—ä¸²è¦å‰‡ï¼Œå› æ­¤éœ€é€²å…¥æ²™ç®±å‹•æ…‹é©—è­‰ã€‚</p>

                    <h4>3.4 Phase 3ï¼šSandbox Trialï¼ˆæ²™ç®±è©¦è·‘ï¼‰</h4>
                    <p>åœ¨éš”é›¢ç’°å¢ƒå¯¦éš›åŸ·è¡Œ Skillï¼Œé©—è­‰è¡Œç‚ºæ˜¯å¦èˆ‡å®£å‘Šä¸€è‡´ã€‚</p>

                    <p><strong>éš”é›¢å±¤ç´šï¼ˆç”±å¼±åˆ°å¼·ï¼‰</strong></p>
                    <ul>
                        <li>Node.js <code>vm</code>ï¼ˆä¸å»ºè­°å–®ç¨ä¾è³´ï¼Œæ­·å²ä¸Šæœ‰é€ƒé€¸é¢¨éšªï¼‰</li>
                        <li>gVisorï¼ˆsyscall å±¤æ””æˆªï¼‰</li>
                        <li>Firecracker microVMï¼ˆé«˜éš”é›¢ï¼‰</li>
                    </ul>

                    <p><strong>è©¦è·‘ç›£æ§</strong></p>
                    <ul>
                        <li>ç¶²è·¯ï¼šDNS/TCP é€£ç·šç´€éŒ„ï¼Œæœªæˆæ¬Šå¤–è¯ç«‹å³æ¨™è¨˜ã€‚</li>
                        <li>æª”æ¡ˆï¼š<code>open/read/write</code> å­˜å–æ˜¯å¦è¶…å‡ºç™½åå–®ã€‚</li>
                        <li>ç¨‹åºï¼šç¦æ­¢ <code>fork/exec</code>ï¼›CPU &gt; 5 ç§’æˆ–è¨˜æ†¶é«” &gt; 128 MB å³çµ‚æ­¢ã€‚</li>
                        <li>è¡Œç‚ºä¸€è‡´æ€§ï¼šä»¥ mock è¼¸å…¥åŸ·è¡Œï¼Œæª¢æŸ¥è¼¸å‡ºæ˜¯å¦ç¬¦åˆ manifest schemaã€‚</li>
                    </ul>

                    <pre><code class="language-javascript">const result = await skill.run(
  { filepath: "/home/user/documents/test.txt" },
  { permissions: mockPermissions, logger: mockLogger }
);
validateAgainstSchema(result, skill.manifest.schema.output);</code></pre>

                    <h4>3.5 Phase 4ï¼šSignature Verificationï¼ˆæ•¸ä½ç°½ç« é©—è­‰ï¼‰</h4>
                    <p>ç¢ºä¿ã€Œé€šéå¯©æŸ¥çš„å…§å®¹ã€åœ¨ç™¼å¸ƒèˆ‡å®‰è£éç¨‹ä¸­æœªè¢«ç«„æ”¹ã€‚</p>

                    <p><strong>ç™¼å¸ƒç«¯</strong></p>
                    <ol>
                        <li>å° <code>manifest + entrypoint</code> åš SHA-256ã€‚</li>
                        <li>ç”¨ç™¼å¸ƒè€…ç§é‘°ç°½ç« ï¼Œç”¢ç”Ÿ <code>skill.sig</code>ã€‚</li>
                    </ol>

                    <p><strong>å¹³å°é©—è­‰ç«¯</strong></p>
                    <ol>
                        <li>å°æ”¶åˆ°çš„ <code>manifest + entrypoint</code> é‡æ–°è¨ˆç®— SHA-256ã€‚</li>
                        <li>ç”¨è¨»å†Šå…¬é‘°é©—è­‰ç°½ç« ã€‚</li>
                        <li>ä¸ä¸€è‡´å³æ‹’çµ•ä¸Šæ¶/å®‰è£ã€‚</li>
                    </ol>

                    <h4>3.6 å…©å€‹ Skill Pluginï¼ˆè½åœ°ç¤ºä¾‹ï¼‰</h4>
                    <ol>
                        <li><strong><code>system_info</code></strong>ï¼šæŸ¥è©¢ç³»çµ±æ™‚é–“ã€æ™‚å€ã€hostnameï¼›<code>network=false</code>ã€<code>exec=false</code>ï¼Œä¸¦åœ¨åŸ·è¡Œæ™‚ä»¥ <code>context.permissions.require()</code> å†åš runtime gateã€‚</li>
                        <li><strong><code>file_summarizer</code></strong>ï¼šè®€å–ç™½åå–®ç›®éŒ„æ–‡å­—æª”ï¼ŒåŒ…å«äº”å±¤é˜²è­·ï¼ˆnull byte é˜²è­·ã€<code>path.resolve()</code> æ­£è¦åŒ–ã€ç™½åå–®ç›®éŒ„æ¯”å°ã€å‰¯æª”åç™½åå–®ã€1MB å¤§å°é™åˆ¶ï¼‰ã€‚</li>
                    </ol>

                    <h4>3.7 ç¸±æ·±é˜²ç¦¦ç¸½çµ</h4>
                    <p><code>Phase 1 -&gt; Phase 2 -&gt; Phase 3 -&gt; Phase 4</code> åˆ†åˆ¥è™•ç†å®£å‘Šåˆè¦ã€éœæ…‹é¢¨éšªã€å‹•æ…‹è¡Œç‚ºèˆ‡å®Œæ•´æ€§é©—è­‰ã€‚ä»»ä¸€éšæ®µå‘½ä¸­ <code>CRITICAL/ERROR</code> å³ä¸­æ­¢æµç¨‹ï¼Œé™ä½æƒ¡æ„ Skill é€²å…¥ç”Ÿæ…‹ç³»æ©Ÿç‡ã€‚</p>
                </div>
            </section>
        </main>
    </div>
<script type="module">
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";

    mermaid.initialize({
        startOnLoad: true,
        theme: "default",
        securityLevel: "strict",
        fontFamily: "Noto Sans TC, PingFang TC, Microsoft JhengHei, sans-serif"
    });
</script>
</body>
</html>
